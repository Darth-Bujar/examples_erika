/** \file   master.c
 *  \brief  Main application.
 *
 *  This file contains the code of can example for TC387x using RTOS Erika.
 *
 *  \author Danylo Begim
 *  \date   2023
 */

/*********************************************************************************************************************/
/*-------------------------------------------------INCLUDE-----------------------------------------------------------*/
/*********************************************************************************************************************/
/* ERIKA Enterprise. */
//#include "ee_internal.h"


#include <stdio.h>
#include "shared.h"
#include "can_control.h"
#include "Ifx_Types.h"
#include "IfxCpu.h"
#include "IfxScuWdt.h"
#include "IfxCan.h"
#include "ee.h"

#if (defined(__TASKING__))

    #define OS_CORE0_START_SEC_CODE
    #include "Os_MemMap.h"

#endif /* __TASKING__ */
#if (defined(__TASKING__))
    #define OS_CORE0_STOP_SEC_CODE
    #include "Os_MemMap.h"
#endif /* __TASKING__ */

#define KEEP_ALIVE_CAN_MESSAGE_ID 1
/*********************************************************************************************************************/
/*-------------------------------------------------Macro defenitions-------------------------------------------------*/
/*********************************************************************************************************************/
/*********************************************************************************************************************/
/*-------------------------------------------------Local variables--------------------------------------------------*/
/*********************************************************************************************************************/
/*********************************************************************************************************************/
/*---------------------------------------------LOCAL FUNCTION DEFENITIO----------------------------------------------*/
/*********************************************************************************************************************/
void idle_hook_core0(void);                                        /* idle hool defenition for core 0                */
/*********************************************************************************************************************/
/*-------------------------------------------------TASKS DEFINITION--------------------------------------------------*/
/*********************************************************************************************************************/
/* This task called only once after start of ERIKA RTOS. Defined byt
 * Properties:
 *                 AUTOSTART = TRUE;
 *                 ACTIVATION = 1;
 */
TASK(can_keep_alive_task)
{
    send_keep_alive_message();
    TerminateTask();
}
/*********************************************************************************************************************/
/*-------------------------------------------------FUNCTION DEFINITION-----------------------------------------------*/
/*********************************************************************************************************************/
/*
 * MAIN TASK
 */
int main(void)
{
  can_init();
  // Start ERIKA RTOS
  StartOS(0);

  return 0;
}

/*********************************************************************************************************************/
/*-------------------------------------------------ERIKA`s special function definition-------------------------------*/
/*********************************************************************************************************************/
void idle_hook_core0(void)
{
  idle_hook_body();
}

